define(["jquery","app","ajax","guids"],function(n,t,i,r){n(document).popover({selector:'[data-profile*="popover"][data-id]',html:!0,trigger:"hover",container:"body",placement:"top",delay:{hide:1e3},content:function(){n(".popover:visible").hide();var f=n(this).data("id"),u="view-profilepopover-{0}".format(r.newGuid());return i.html({url:t.path("profile/popoversummary/"+f),success:function(t){n("#"+u).html(t)}}),'<div id="'+u+'" class="view-profilepopover"><div class="text-center"><img src="'+t.path("Content/images/loading/bar-sm.gif")+'" /><\/div><\/div>'}});n(document).on("click",'[data-profile*="modal"][data-id]',function(i){var u,f,r,e;i.preventDefault();u=n("#profilemodal");u.length==0&&(f='<div class="modal" id="profilemodal" data-keyboard="false" tabindex="-1" role="dialog" aria-labelledby="profilemodalLabel" aria-hidden="true"><div class="modal-dialog modal-lg"><div class="modal-content"><div class="modal-header"><button type="button" class="close" data-dismiss="modal"><span aria-hidden="true">&times;<\/span><span class="sr-only">Close<\/span><\/button><h4 class="modal-title" id="profilemodalLabel">Customer Details<\/h4><\/div><div class="modal-body"><!-- Dynamically loaded content --><\/div><div class="modal-footer"><a class="btn btn-default" data-dismiss="modal">Close<\/a><\/div><\/div><\/div><\/div>',n("body").append(f));r=n(this).data("id");e=n(this).data("token");n.ajax({url:t.path("profile/"+e),cache:!1,beforeSend:function(){n("#profilemodal .modal-body").html("Loading ID# "+r+" - please wait...");n("#profilemodal").modal("show")},success:function(t){n("#profilemodal .modal-body").html(t)},error:function(t,i,u){n("#profilemodal .modal-body").html("Unable to load ID# "+r+": "+u);console.log(t)}})})});